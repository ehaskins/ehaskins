{"componentChunkName":"component---src-templates-blog-post-js","path":"/2015-09-22 Script - Using SCCM and MDT task sequence variables in PowerShell/","webpackCompilationHash":"04c9b1c30955a8ce71b4","result":{"data":{"site":{"siteMetadata":{"title":"Eric Haskins","author":"Eric Haskins"}},"markdownRemark":{"id":"ac6d746f-be01-544d-bb25-2b404f9ef7a9","html":"<h1>Just the code</h1>\n<h2>Get TSEnv instance</h2>\n<div class=\"gatsby-highlight\" data-language=\"text\"><pre class=\"language-text\"><code class=\"language-text\">$ts = New-Object -COMObject Microsoft.SMS.TSEnvironment </code></pre></div>\n<h2>Read a variable</h2>\n<div class=\"gatsby-highlight\" data-language=\"text\"><pre class=\"language-text\"><code class=\"language-text\">$foo = $ts.Value(&quot;Foo&quot;)</code></pre></div>\n<h2>Set or create a variable</h2>\n<div class=\"gatsby-highlight\" data-language=\"text\"><pre class=\"language-text\"><code class=\"language-text\">$ts.Value(&quot;Bar&quot;) = $bar</code></pre></div>\n<h2>Get all of the variables</h2>\n<div class=\"gatsby-highlight\" data-language=\"text\"><pre class=\"language-text\"><code class=\"language-text\">$ts.GetVariables() | ForEach-Object {\n\tNew-Object psobject -Property @{\n\t\tName=$_;\n\t\tValue=$ts.Value($_)\n\t}\n}</code></pre></div>\n<h2>Write a subset of the variables to a JSON file</h2>\n<p>Building on the last snippet we can write that to a JSON file on disk.</p>\n<div class=\"gatsby-highlight\" data-language=\"text\"><pre class=\"language-text\"><code class=\"language-text\">$ts.GetVariables() `\n| Where-Object {$_ -notlike &quot;_*&quot;} `\n| ForEach-Object {\n\tNew-Object psobject -Property @{\n\t\tName=$_;\n\t\tValue=$ts.Value($_)\n\t}\n} `\n| ConvertTo-Json `\n| Set-Content &#39;tsVariables.json&#39;</code></pre></div>\n<h2>Read the variables back, and update them from the JSON file</h2>\n<div class=\"gatsby-highlight\" data-language=\"text\"><pre class=\"language-text\"><code class=\"language-text\">$json = Get-Content &#39;tsVariables.json&#39; | ConvertFrom-Json\n$json | ForEach-Object {$ts.Value($_.Name) = $_.Value}</code></pre></div>","frontmatter":{"title":"Script - Using SCCM and MDT task sequence variables in PowerShell","date":"September 22, 2015"}}},"pageContext":{"isCreatedByStatefulCreatePages":false,"slug":"/2015-09-22 Script - Using SCCM and MDT task sequence variables in PowerShell/"}}}